<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.1/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.1/js/buttons.flash.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.1/js/buttons.html5.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.4.1/js/buttons.print.min.js"></script>
<!-- <script src="https://js.stripe.com/v3/"></script> -->

<p id="notice"><%= notice %></p>
<h1 class="text-center">Cart Items</h1>
<!-- <script src="http://localhost/assets/js/ZeroClipboard.js"></script>  -->
<table class=" myTable table table-hover" id="cartpdf">
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Image</th>
      <th>Category</th>
      <th>Quantity</th>
      <th>Price</th>
      <th colspan="4"></th>
    </tr>
  </thead>

  <tbody>
    <% if @products.present? %>
    <% @products.each do |product| %>
      <tr>
        <td><%= product.name %></td>
        <td><%= product.description %></td>
        <td><a href="/product/<%= product.id %>"><%= image_tag product.image.url(:thumb) %></a></td>
        <td><%= product.category.name %></td>
        <td>
          <div class="input-group">
            <div class="input-group-btn">
                <button id="down" class="btn btn-default" onclick=" down('0')"><span class="glyphicon glyphicon-minus"></span></button>
            </div>
            <input type="text" id="myNumber" class="form-control input-number" value="1" />
            <div class="input-group-btn">
                <button id="up" class="btn btn-default" onclick="up('10')"><span class="glyphicon glyphicon-plus"></span></button>
            </div>
          </div>
          <%#= form_with url: order_path, remote: true do |f| %>
          <!-- <td>
            <%#= link_to "Add (+1)", cart_item_add_path(:id => cart_item), method: :post %> 
          </td>
          <td>
             <%#= link_to "Reduce (-1)", cart_item_reduce_path(:id => cart_item), method: :post %>
          </td>
              <td><%#= link_to "Remove",  remove_cart_path(product), data: {method: :delete, remote: true}  %>
              </td> --> 
          <%# end %>
            <td><%= product.price %></td>
        </td>
          <td><%= link_to "Remove",  remove_cart_path(product), data: {method: :delete, remote: true}  %>
          </td> 
      </div>
      </tr>
    <% end %>
    <% end %>
  </tbody>
</table><br>

  <script type="text/javascript">
        $("#up").on("click", function() {
       var defaultValue = parseInt($("#price").text());
       var addedValue = parseInt($("#qty").val());
        if(isNumber(addedValue) && addedValue >0) {
            $("#price").html(
                defaultValue + addedValue
            );
        }
    })
  </script>

    <div class="float-right p-2 mb-2 bg-success text-white " style="margin-right: 3%" >
      Total Price: <%= @products.map(&:price).sum %>
    </div>
    <div class="float-right p-2 mb-2 bg-success text-white " style="margin-right: 5%" >
      Total Quantity: <%= @products.count %>&nbsp;&nbsp;
    </div>
    <br><br>
    
    <div class="text-center ">
      <div class="btn-group">
        <%#= button_to 'Place Order', order_path(count: @products.count, product_id: @products.ids), :class => "btn btn-info" %>&nbsp;&nbsp;
        <%= button_to 'Checkout',  charges_path, :class => "btn btn-secondary" %>
      </div>
    </div>


<script type="text/javascript">
  $('#cartpdf').DataTable({
    dom: 'Bfrtip',
    buttons: [
        'copy', 'excel', 'pdf', 'csv'
    ]
} );
</script>



<!-- <div class="container">
  <input type="button" onclick="decrementValue()" value="-" />
  <input type="text" name="quantity" value="1" maxlength="2" max="10" size="1" id="number" />
  <input type="button" onclick="incrementValue()" value="+" />
</div>


<script type="text/javascript">
function incrementValue()
{
    var value = parseInt(document.getElementById('number').value, 10);
    value = isNaN(value) ? 0 : value;
    if(value<10){
        value++;
            document.getElementById('number').value = value;
    }
}
function decrementValue()
{
    var value = parseInt(document.getElementById('number').value, 10);
    value = isNaN(value) ? 0 : value;
    if(value>1){
        value--;
            document.getElementById('number').value = value;
    }

}
</script> -->




<!-- Increment decrement  -->
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<%#= form_with url: order_path, remote: true do |f| %>
  <input type="button" value="-" id="minus" />
  <input type="text" id="quantity" value="" name="quantity" />
  <input type="button" value="+" id="plus" />
  <br />
  <input id="total-price" readonly="readonly" value=""/>
<%# end %>

<script type="text/javascript">
  $('#plus').click(function add() {
  var $qtde = $("#quantity");
  var a = $qtde.val();

  a++;
  $("#minus").attr("disabled", !a);
  $qtde.val(a);
});
$("#minus").attr("disabled", !$("#quantity").val());

$('#minus').click(function minust() {
  var $qtde = $("#quantity");
  var b = $qtde.val();
  if (b >= 1) {
    b--;
    $qtde.val(b);
  } else {
    $("#minus").attr("disabled", true);
  }
});

/* On change */
$(document).ready(function() {
  function updatePrice() {
    var price = parseFloat($("#quantity").val());
    var total = (price + 1) * 1.05;
    var total = total.toFixed(2);
    $("#total-price").val(total);
  }
  // On the click of an input, update the price
  $(document).on("click", "input", updatePrice);
});
</script> -->

<!-- <script type="text/javascript">
  var stripe = Stripe('pk_test_WOuxu6ZZPDsPH6NEpxUYKagu00nMNIXrtl');
</script> -->

<!-- <script type="text/javascript">
  $(document).ready(function() {
    $('#example33').DataTable( {
        dom: 'Bfrtip',
        buttons: [
            {
                extend: 'pdfHtml5',
                orientation: 'landscape',
                pageSize: 'LEGAL'
            }
        ]
    } );
} );
</script> -->

<!-- <script type="text/javascript">
  
  $('#plus').click(function add() {
  var $qtde = $("#quantity");
  var a = $qtde.val();

  a++;
  $("#minus").attr("disabled", !a);
  $qtde.val(a);
});
$("#minus").attr("disabled", !$("#quantity").val());

$('#minus').click(function minust() {
  var $qtde = $("#quantity");
  var b = $qtde.val();
  if (b >= 1) {
    b--;
    $qtde.val(b);
  } else {
    $("#minus").attr("disabled", true);
  }
});

/* On change */
$(document).ready(function() {
  function updatePrice() {
    var price = parseFloat($("#quantity").val());
    var total = (price + 1) * 1.05;
    var total = total.toFixed(2);
    $("#total-price").val(total);
  }
  // On the click of an input, update the price
  $(document).on("click", "input", updatePrice);
});
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input type="button" value="-" id="minus" />
<input type="text" id="quantity" value="" name="quantity" />
<input type="button" value="+" id="plus" />
<br />
<input id="total-price" readonly="readonly" value="" /> -->
<!-- 
<form id="confirmInfo" action="bookingsuccess.html">
  <p>Number of tickets :<input id="num" type="text" oninput="calc()" /> </p>
  <p>Price Per ticket : $<span id="ticket_price">7</span></p>
  <p>Booking fee : $2</p>
  <p>Subtotal : <b>$<span id="total">0</span></b></p>


  <form name="myform" action="bookingsuccess.php" method="post">
    <button>Book</button>
  </form>
  <button>Cancel</button>
</form> -->